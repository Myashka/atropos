[2025-06-30 03:31:15] Fail to set RLIMIT_NOFILE: current limit exceeds maximum limit
[2025-06-30 03:31:15] server_args=ServerArgs(model_path='NousResearch/Hermes-3-Llama-3.1-8B', tokenizer_path='NousResearch/Hermes-3-Llama-3.1-8B', tokenizer_mode='auto', skip_tokenizer_init=False, load_format='auto', trust_remote_code=True, dtype='auto', kv_cache_dtype='auto', quantization=None, quantization_param_path=None, context_length=None, device='cuda', served_model_name='NousResearch/Hermes-3-Llama-3.1-8B', chat_template=None, completion_template=None, is_embedding=False, enable_multimodal=None, revision=None, impl='auto', host='0.0.0.0', port=9000, mem_fraction_static=0.821, max_running_requests=None, max_total_tokens=None, chunked_prefill_size=16384, max_prefill_tokens=16384, schedule_policy='fcfs', schedule_conservativeness=1.0, cpu_offload_gb=0, page_size=1, tp_size=8, pp_size=1, max_micro_batch_size=None, stream_interval=1, stream_output=False, random_seed=492822299, constrained_json_whitespace_pattern=None, watchdog_timeout=300, dist_timeout=None, download_dir=None, base_gpu_id=0, gpu_id_step=1, sleep_on_idle=False, log_level='info', log_level_http=None, log_requests=False, log_requests_level=0, show_time_cost=False, enable_metrics=False, bucket_time_to_first_token=None, bucket_e2e_request_latency=None, bucket_inter_token_latency=None, collect_tokens_histogram=False, decode_log_interval=40, enable_request_time_stats_logging=False, kv_events_config=None, api_key=None, file_storage_path='sglang_storage', enable_cache_report=False, reasoning_parser=None, tool_call_parser=None, dp_size=1, load_balance_method='round_robin', dist_init_addr=None, nnodes=1, node_rank=0, json_model_override_args='{}', preferred_sampling_params=None, lora_paths=None, max_loras_per_batch=8, lora_backend='triton', attention_backend='triton', sampling_backend='flashinfer', grammar_backend='xgrammar', mm_attention_backend=None, speculative_algorithm=None, speculative_draft_model_path=None, speculative_num_steps=None, speculative_eagle_topk=None, speculative_num_draft_tokens=None, speculative_accept_threshold_single=1.0, speculative_accept_threshold_acc=1.0, speculative_token_map=None, ep_size=1, enable_ep_moe=False, enable_deepep_moe=False, deepep_mode='auto', ep_num_redundant_experts=0, ep_dispatch_algorithm='static', init_expert_location='trivial', enable_eplb=False, eplb_algorithm='auto', eplb_rebalance_num_iterations=1000, eplb_rebalance_layers_per_chunk=None, expert_distribution_recorder_mode=None, expert_distribution_recorder_buffer_size=1000, enable_expert_distribution_metrics=False, deepep_config=None, moe_dense_tp_size=None, enable_double_sparsity=False, ds_channel_config_path=None, ds_heavy_channel_num=32, ds_heavy_token_num=256, ds_heavy_channel_type='qk', ds_sparse_decode_threshold=4096, disable_radix_cache=False, cuda_graph_max_bs=None, cuda_graph_bs=None, disable_cuda_graph=False, disable_cuda_graph_padding=False, enable_profile_cuda_graph=False, enable_nccl_nvls=False, enable_tokenizer_batch_encode=False, disable_outlines_disk_cache=True, disable_custom_all_reduce=False, enable_mscclpp=False, disable_overlap_schedule=False, disable_overlap_cg_plan=False, enable_mixed_chunk=False, enable_dp_attention=False, enable_dp_lm_head=False, enable_two_batch_overlap=False, enable_torch_compile=False, torch_compile_max_bs=32, torchao_config='', enable_nan_detection=False, enable_p2p_check=False, triton_attention_reduce_in_fp32=False, triton_attention_num_kv_splits=8, num_continuous_decode_steps=1, delete_ckpt_after_loading=False, enable_memory_saver=False, allow_auto_truncate=False, enable_custom_logit_processor=False, enable_hierarchical_cache=False, hicache_ratio=2.0, hicache_size=0, hicache_write_policy='write_through_selective', flashinfer_mla_disable_ragged=False, disable_shared_experts_fusion=False, disable_chunked_prefix_cache=False, disable_fast_image_processor=False, enable_return_hidden_states=False, warmups=None, debug_tensor_dump_output_folder=None, debug_tensor_dump_input_file=None, debug_tensor_dump_inject=False, debug_tensor_dump_prefill_only=False, disaggregation_mode='null', disaggregation_transfer_backend='mooncake', disaggregation_bootstrap_port=8998, disaggregation_decode_tp=None, disaggregation_decode_dp=None, disaggregation_prefill_pp=1, disaggregation_ib_device=None, num_reserved_decode_tokens=512, pdlb_url=None)
[2025-06-30 03:31:26 TP0] Init torch distributed begin.
[2025-06-30 03:31:30 TP0] sglang is using nccl==2.26.2
[2025-06-30 03:32:26 TP0] Init torch distributed ends. mem usage=1.44 GB
[2025-06-30 03:32:28 TP0] Load weight begin. avail mem=176.31 GB
[2025-06-30 03:32:28 TP0] Using model weights format ['*.safetensors']
[2025-06-30 03:32:28 TP6] Using model weights format ['*.safetensors']
[2025-06-30 03:32:28 TP1] Using model weights format ['*.safetensors']
[2025-06-30 03:32:28 TP5] Using model weights format ['*.safetensors']
[2025-06-30 03:32:28 TP4] Using model weights format ['*.safetensors']
[2025-06-30 03:32:28 TP3] Using model weights format ['*.safetensors']
[2025-06-30 03:32:28 TP7] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
[2025-06-30 03:32:28 TP2] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:00,  4.18it/s]
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:00<00:00,  3.64it/s]
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:00<00:00,  3.59it/s]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:00<00:00,  4.40it/s]

[2025-06-30 03:32:29 TP0] Load weight end. type=LlamaForCausalLM, dtype=torch.bfloat16, avail mem=174.38 GB, mem usage=1.93 GB.
[2025-06-30 03:32:30 TP3] KV Cache is allocated. #tokens: 9356637, K size: 71.39 GB, V size: 71.39 GB
[2025-06-30 03:32:30 TP6] KV Cache is allocated. #tokens: 9356637, K size: 71.39 GB, V size: 71.39 GB
[2025-06-30 03:32:30 TP5] KV Cache is allocated. #tokens: 9356637, K size: 71.39 GB, V size: 71.39 GB
[2025-06-30 03:32:30 TP7] KV Cache is allocated. #tokens: 9356637, K size: 71.39 GB, V size: 71.39 GB
[2025-06-30 03:32:30 TP4] KV Cache is allocated. #tokens: 9356637, K size: 71.39 GB, V size: 71.39 GB
[2025-06-30 03:32:30 TP0] KV Cache is allocated. #tokens: 9356637, K size: 71.39 GB, V size: 71.39 GB
[2025-06-30 03:32:30 TP0] Memory pool end. avail mem=29.43 GB
[2025-06-30 03:32:30 TP1] KV Cache is allocated. #tokens: 9356637, K size: 71.39 GB, V size: 71.39 GB
[2025-06-30 03:32:30 TP2] KV Cache is allocated. #tokens: 9356637, K size: 71.39 GB, V size: 71.39 GB
[2025-06-30 03:32:30 TP0] Capture cuda graph begin. This can take up to several minutes. avail mem=29.35 GB
[2025-06-30 03:32:30 TP0] Capture cuda graph bs [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 272, 288, 304, 320, 336, 352, 368, 384, 400, 416, 432, 448, 464, 480, 496, 512]
  0%|          | 0/51 [00:00<?, ?it/s]Capturing batches (avail_mem=29.04 GB):   0%|          | 0/51 [00:00<?, ?it/s]Capturing batches (avail_mem=29.04 GB):   2%|▏         | 1/51 [00:02<02:27,  2.94s/it]Capturing batches (avail_mem=28.48 GB):   2%|▏         | 1/51 [00:02<02:27,  2.94s/it]Capturing batches (avail_mem=28.48 GB):   4%|▍         | 2/51 [00:03<01:07,  1.38s/it]Capturing batches (avail_mem=28.24 GB):   4%|▍         | 2/51 [00:03<01:07,  1.38s/it]Capturing batches (avail_mem=28.24 GB):   6%|▌         | 3/51 [00:03<00:51,  1.07s/it]Capturing batches (avail_mem=28.00 GB):   6%|▌         | 3/51 [00:03<00:51,  1.07s/it]Capturing batches (avail_mem=28.00 GB):   8%|▊         | 4/51 [00:04<00:34,  1.36it/s]Capturing batches (avail_mem=27.77 GB):   8%|▊         | 4/51 [00:04<00:34,  1.36it/s]Capturing batches (avail_mem=27.77 GB):  10%|▉         | 5/51 [00:04<00:26,  1.75it/s]Capturing batches (avail_mem=27.55 GB):  10%|▉         | 5/51 [00:04<00:26,  1.75it/s]Capturing batches (avail_mem=27.55 GB):  12%|█▏        | 6/51 [00:04<00:21,  2.08it/s]Capturing batches (avail_mem=27.34 GB):  12%|█▏        | 6/51 [00:04<00:21,  2.08it/s]Capturing batches (avail_mem=27.34 GB):  14%|█▎        | 7/51 [00:05<00:18,  2.35it/s]Capturing batches (avail_mem=27.13 GB):  14%|█▎        | 7/51 [00:05<00:18,  2.35it/s]Capturing batches (avail_mem=27.13 GB):  16%|█▌        | 8/51 [00:05<00:16,  2.64it/s]Capturing batches (avail_mem=26.94 GB):  16%|█▌        | 8/51 [00:05<00:16,  2.64it/s]Capturing batches (avail_mem=26.94 GB):  18%|█▊        | 9/51 [00:05<00:14,  2.85it/s]Capturing batches (avail_mem=26.75 GB):  18%|█▊        | 9/51 [00:05<00:14,  2.85it/s]Capturing batches (avail_mem=26.75 GB):  20%|█▉        | 10/51 [00:05<00:14,  2.90it/s]Capturing batches (avail_mem=26.57 GB):  20%|█▉        | 10/51 [00:05<00:14,  2.90it/s]Capturing batches (avail_mem=26.57 GB):  22%|██▏       | 11/51 [00:07<00:33,  1.20it/s]Capturing batches (avail_mem=26.39 GB):  22%|██▏       | 11/51 [00:07<00:33,  1.20it/s]Capturing batches (avail_mem=26.39 GB):  24%|██▎       | 12/51 [00:08<00:28,  1.38it/s]Capturing batches (avail_mem=26.23 GB):  24%|██▎       | 12/51 [00:08<00:28,  1.38it/s]Capturing batches (avail_mem=26.23 GB):  25%|██▌       | 13/51 [00:08<00:22,  1.72it/s]Capturing batches (avail_mem=26.07 GB):  25%|██▌       | 13/51 [00:08<00:22,  1.72it/s]Capturing batches (avail_mem=26.07 GB):  27%|██▋       | 14/51 [00:08<00:18,  1.97it/s]Capturing batches (avail_mem=25.91 GB):  27%|██▋       | 14/51 [00:08<00:18,  1.97it/s]Capturing batches (avail_mem=25.91 GB):  29%|██▉       | 15/51 [00:09<00:16,  2.24it/s]Capturing batches (avail_mem=25.77 GB):  29%|██▉       | 15/51 [00:09<00:16,  2.24it/s]Capturing batches (avail_mem=25.77 GB):  31%|███▏      | 16/51 [00:09<00:14,  2.41it/s]Capturing batches (avail_mem=25.64 GB):  31%|███▏      | 16/51 [00:09<00:14,  2.41it/s]Capturing batches (avail_mem=25.64 GB):  33%|███▎      | 17/51 [00:10<00:18,  1.83it/s]Capturing batches (avail_mem=25.61 GB):  33%|███▎      | 17/51 [00:10<00:18,  1.83it/s]Capturing batches (avail_mem=25.61 GB):  35%|███▌      | 18/51 [00:10<00:17,  1.92it/s]Capturing batches (avail_mem=25.48 GB):  35%|███▌      | 18/51 [00:10<00:17,  1.92it/s]Capturing batches (avail_mem=25.48 GB):  37%|███▋      | 19/51 [00:11<00:16,  1.98it/s]Capturing batches (avail_mem=25.36 GB):  37%|███▋      | 19/51 [00:11<00:16,  1.98it/s]Capturing batches (avail_mem=25.36 GB):  39%|███▉      | 20/51 [00:11<00:15,  1.96it/s]Capturing batches (avail_mem=25.24 GB):  39%|███▉      | 20/51 [00:11<00:15,  1.96it/s]Capturing batches (avail_mem=25.24 GB):  41%|████      | 21/51 [00:12<00:14,  2.03it/s]Capturing batches (avail_mem=24.54 GB):  41%|████      | 21/51 [00:12<00:14,  2.03it/s]Capturing batches (avail_mem=24.54 GB):  43%|████▎     | 22/51 [00:12<00:12,  2.25it/s]Capturing batches (avail_mem=24.44 GB):  43%|████▎     | 22/51 [00:12<00:12,  2.25it/s]Capturing batches (avail_mem=24.44 GB):  45%|████▌     | 23/51 [00:13<00:12,  2.30it/s]Capturing batches (avail_mem=24.33 GB):  45%|████▌     | 23/51 [00:13<00:12,  2.30it/s]Capturing batches (avail_mem=24.33 GB):  47%|████▋     | 24/51 [00:14<00:22,  1.18it/s]Capturing batches (avail_mem=24.23 GB):  47%|████▋     | 24/51 [00:14<00:22,  1.18it/s]Capturing batches (avail_mem=24.23 GB):  49%|████▉     | 25/51 [00:15<00:17,  1.46it/s]Capturing batches (avail_mem=24.13 GB):  49%|████▉     | 25/51 [00:15<00:17,  1.46it/s]Capturing batches (avail_mem=24.13 GB):  51%|█████     | 26/51 [00:15<00:14,  1.75it/s]Capturing batches (avail_mem=24.04 GB):  51%|█████     | 26/51 [00:15<00:14,  1.75it/s]Capturing batches (avail_mem=24.04 GB):  53%|█████▎    | 27/51 [00:15<00:11,  2.01it/s]Capturing batches (avail_mem=23.95 GB):  53%|█████▎    | 27/51 [00:15<00:11,  2.01it/s]Capturing batches (avail_mem=23.95 GB):  55%|█████▍    | 28/51 [00:16<00:10,  2.17it/s]Capturing batches (avail_mem=23.86 GB):  55%|█████▍    | 28/51 [00:16<00:10,  2.17it/s]Capturing batches (avail_mem=23.86 GB):  57%|█████▋    | 29/51 [00:16<00:09,  2.36it/s]Capturing batches (avail_mem=23.78 GB):  57%|█████▋    | 29/51 [00:16<00:09,  2.36it/s]Capturing batches (avail_mem=23.78 GB):  59%|█████▉    | 30/51 [00:17<00:10,  1.98it/s]Capturing batches (avail_mem=23.70 GB):  59%|█████▉    | 30/51 [00:17<00:10,  1.98it/s]Capturing batches (avail_mem=23.70 GB):  61%|██████    | 31/51 [00:17<00:08,  2.28it/s]Capturing batches (avail_mem=23.62 GB):  61%|██████    | 31/51 [00:17<00:08,  2.28it/s]Capturing batches (avail_mem=23.62 GB):  63%|██████▎   | 32/51 [00:18<00:11,  1.61it/s]Capturing batches (avail_mem=24.16 GB):  63%|██████▎   | 32/51 [00:18<00:11,  1.61it/s]Capturing batches (avail_mem=24.16 GB):  65%|██████▍   | 33/51 [00:18<00:09,  1.87it/s]Capturing batches (avail_mem=24.15 GB):  65%|██████▍   | 33/51 [00:18<00:09,  1.87it/s]Capturing batches (avail_mem=24.15 GB):  67%|██████▋   | 34/51 [00:19<00:07,  2.13it/s]Capturing batches (avail_mem=24.08 GB):  67%|██████▋   | 34/51 [00:19<00:07,  2.13it/s]Capturing batches (avail_mem=24.08 GB):  69%|██████▊   | 35/51 [00:19<00:06,  2.35it/s]Capturing batches (avail_mem=24.03 GB):  69%|██████▊   | 35/51 [00:19<00:06,  2.35it/s]Capturing batches (avail_mem=24.03 GB):  71%|███████   | 36/51 [00:19<00:05,  2.55it/s]Capturing batches (avail_mem=23.97 GB):  71%|███████   | 36/51 [00:19<00:05,  2.55it/s]Capturing batches (avail_mem=23.97 GB):  73%|███████▎  | 37/51 [00:20<00:05,  2.60it/s]Capturing batches (avail_mem=23.92 GB):  73%|███████▎  | 37/51 [00:20<00:05,  2.60it/s]Capturing batches (avail_mem=23.92 GB):  75%|███████▍  | 38/51 [00:20<00:04,  2.81it/s]Capturing batches (avail_mem=23.87 GB):  75%|███████▍  | 38/51 [00:20<00:04,  2.81it/s]Capturing batches (avail_mem=23.87 GB):  76%|███████▋  | 39/51 [00:20<00:04,  2.98it/s]Capturing batches (avail_mem=23.86 GB):  76%|███████▋  | 39/51 [00:20<00:04,  2.98it/s]Capturing batches (avail_mem=23.86 GB):  78%|███████▊  | 40/51 [00:21<00:03,  3.03it/s]Capturing batches (avail_mem=23.82 GB):  78%|███████▊  | 40/51 [00:21<00:03,  3.03it/s]Capturing batches (avail_mem=23.82 GB):  80%|████████  | 41/51 [00:21<00:03,  3.17it/s]Capturing batches (avail_mem=23.79 GB):  80%|████████  | 41/51 [00:21<00:03,  3.17it/s]Capturing batches (avail_mem=23.79 GB):  82%|████████▏ | 42/51 [00:21<00:02,  3.32it/s]Capturing batches (avail_mem=23.75 GB):  82%|████████▏ | 42/51 [00:21<00:02,  3.32it/s]Capturing batches (avail_mem=23.75 GB):  84%|████████▍ | 43/51 [00:22<00:02,  3.10it/s]Capturing batches (avail_mem=23.73 GB):  84%|████████▍ | 43/51 [00:22<00:02,  3.10it/s]Capturing batches (avail_mem=23.73 GB):  86%|████████▋ | 44/51 [00:22<00:02,  3.15it/s]Capturing batches (avail_mem=23.72 GB):  86%|████████▋ | 44/51 [00:22<00:02,  3.15it/s]Capturing batches (avail_mem=23.72 GB):  88%|████████▊ | 45/51 [00:22<00:01,  3.23it/s]Capturing batches (avail_mem=23.72 GB):  88%|████████▊ | 45/51 [00:22<00:01,  3.23it/s]Capturing batches (avail_mem=23.72 GB):  90%|█████████ | 46/51 [00:23<00:01,  2.90it/s]Capturing batches (avail_mem=23.70 GB):  90%|█████████ | 46/51 [00:23<00:01,  2.90it/s]Capturing batches (avail_mem=23.70 GB):  92%|█████████▏| 47/51 [00:23<00:01,  3.15it/s]Capturing batches (avail_mem=23.70 GB):  92%|█████████▏| 47/51 [00:23<00:01,  3.15it/s]Capturing batches (avail_mem=23.70 GB):  94%|█████████▍| 48/51 [00:23<00:00,  3.14it/s]Capturing batches (avail_mem=23.69 GB):  94%|█████████▍| 48/51 [00:23<00:00,  3.14it/s]Capturing batches (avail_mem=23.69 GB):  96%|█████████▌| 49/51 [00:23<00:00,  3.24it/s]Capturing batches (avail_mem=23.68 GB):  96%|█████████▌| 49/51 [00:23<00:00,  3.24it/s]Capturing batches (avail_mem=23.68 GB):  98%|█████████▊| 50/51 [00:24<00:00,  3.32it/s]Capturing batches (avail_mem=23.68 GB):  98%|█████████▊| 50/51 [00:24<00:00,  3.32it/s][2025-06-30 03:32:55 TP3] Registering 3315 cuda graph addresses
[2025-06-30 03:32:55 TP7] Registering 3315 cuda graph addresses
Capturing batches (avail_mem=23.68 GB): 100%|██████████| 51/51 [00:24<00:00,  3.44it/s]Capturing batches (avail_mem=23.68 GB): 100%|██████████| 51/51 [00:24<00:00,  2.08it/s]
[2025-06-30 03:32:55 TP2] Registering 3315 cuda graph addresses
[2025-06-30 03:32:55 TP0] Registering 3315 cuda graph addresses
[2025-06-30 03:32:55 TP5] Registering 3315 cuda graph addresses
[2025-06-30 03:32:55 TP1] Registering 3315 cuda graph addresses
[2025-06-30 03:32:55 TP6] Registering 3315 cuda graph addresses
[2025-06-30 03:32:55 TP4] Registering 3315 cuda graph addresses
[2025-06-30 03:32:55 TP0] Capture cuda graph end. Time elapsed: 25.09 s. mem usage=5.68 GB. avail mem=23.67 GB.
[2025-06-30 03:32:56 TP0] max_total_num_tokens=9356637, chunked_prefill_size=16384, max_prefill_tokens=16384, max_running_requests=4096, context_len=131072, available_gpu_mem=23.67 GB
[2025-06-30 03:32:56] INFO:     Started server process [589117]
[2025-06-30 03:32:56] INFO:     Waiting for application startup.
[2025-06-30 03:32:56] INFO:     Application startup complete.
[2025-06-30 03:32:56] INFO:     Uvicorn running on http://0.0.0.0:9000 (Press CTRL+C to quit)
[2025-06-30 03:32:57 TP0] Prefill batch. #new-seq: 1, #new-token: 7, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0
[2025-06-30 03:33:07] The server is fired up and ready to roll!
[2025-06-30 03:33:09] SIGTERM received. signum=None frame=None. Draining requests and shutting down...
